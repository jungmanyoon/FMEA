# 기능 분석 가이드 (Function Analysis)

**목적**: AIAG-VDA 7-Step의 Step 3 (기능 분석) 상세 가이드

**근거**: 임채익 이사님 검토 회의 (2025.11.28)

---

## 📑 목차

1. [기능 분석의 중요성](#기능-분석의-중요성)
2. [기능 표현 형식](#기능-표현-형식)
3. [[!!] 기능-고장영향 인과관계 매핑 (CRITICAL!)](#-기능-고장영향-인과관계-매핑-critical)
4. [주기능과 보조기능](#주기능과-보조기능)
5. [부품별 기능 예시](#부품별-기능-예시)
6. [기능분석 시트 권장안](#기능분석-시트-권장안)

---

## 기능 분석의 중요성

### FMEA는 기능에서 시작

> "기능에서 시작해요. 파트가 무슨 역할을 하느냐" (임채익 이사님, 회의록 L100)

**AIAG-VDA 7-Step 흐름**:

```text
Step 2: 구조 분석 (Structure) → 부품 목록, 다이어그램
     ↓
Step 3: 기능 분석 (Function) → 각 부품의 기능 정의 [*]
     ↓
Step 4: 고장 분석 (Failure) → 기능 실패 시 고장 형태/영향
```

### 기능 없이 고장 분석 불가

- [X] **잘못된 접근**: 부품 → 바로 고장 형태 도출
- [OK] **올바른 접근**: 부품 → 기능 정의 → 기능 실패 → 고장 형태

---

## 기능 표현 형식

### 필수 형식: "[목적어]를 [동사]한다"

> "뭘 어떻게 하는건지를 기능으로 써야 돼요" (임채익 이사님, 회의록 L130)

**주어 생략 원칙**: 부품명이 A열에 있으므로, 기능(B열)에서 주어 반복 불필요

### 작성 규칙

| 요소 | 설명 | 예시 |
|------|------|------|
| **목적어** | 작용 대상 | 권선 위치를, 자속을, 전압을 |
| **동사** | 수행 동작 | 고정한다, 전달한다, 변환한다 |

※ A열(부품명) + B열(기능) = 완전한 문장으로 읽힘

### 예시

**[OK] 올바른 표현**:

- "권선 위치를 고정한다" (A열: 클램프)
- "1차-2차 간 자속을 전달한다" (A열: 철심)
- "열을 방출한다" (A열: 절연유)
- "외부 단자와 내부 권선을 연결한다" (A열: 부싱)

**[X] 잘못된 표현**:

- "고정" (목적어 없음)
- "자속 전달" (동사형 아님)
- "권선 지지 기능" (동사 없음)
- "철심이 자속을 전달한다" (주어 반복 - 불필요)

---

## [!!] 기능-고장영향 인과관계 매핑 (CRITICAL!)

### 핵심 원칙

**기능을 정의할 때, 해당 기능 실패 시 발생 가능한 고장영향을 함께 고려해야 함!**

```text
[!] 기능 정의 시 반드시 확인:
"이 기능이 실패하면 어떤 고장영향이 발생하는가?"

잘못된 연결을 발견하면 → 기능 정의가 불완전한 것!
→ 새로운 기능 추가 필요
```

### 변압기 부품별 기능-고장영향 매핑 표

#### 철심(CORE) / 규소강판

| 기능 | 동사 | 기능 실패 의미 | 허용 고장영향 | 금지 고장영향 |
|-----|-----|--------------|-------------|-------------|
| 자속을 전달한다 | 전달 | 자속 전달 실패 | 전압 변환 불가, 전압 변동, 권선 과열 | 소음, 외관, 접지 |
| 손실을 최소화한다 | 최소화 | 손실 증가 | 효율 저하, 온도 상승, 무부하손실 초과 | 소음, 외관, 접지 |
| 진동을 억제한다 | 억제 | 진동 증가 | 소음 기준 초과, 체결부 이완, 피로 파손 | 효율, 절연, 접지 |
| 접지 경로를 제공한다 | 제공 | 접지 불가 | 다점접지, 순환전류, 국부과열 | 외관, 효율, 소음 |
| 외관 품질을 유지한다 | 유지 | 품질 저하 | 외관 불합격, 표면 손상, 변색 | 효율, 접지, 과열 |

#### 권선(WINDING)

| 기능 | 동사 | 기능 실패 의미 | 허용 고장영향 | 금지 고장영향 |
|-----|-----|--------------|-------------|-------------|
| 전압을 변환한다 | 변환 | 변환 불가 | 변압비 오차, 출력 불가 | 소음, 외관 |
| 절연을 유지한다 | 유지 | 절연 파괴 | 단락, 지락, 절연파괴 | 소음, 진동 |
| 전류를 전달한다 | 전달 | 전달 불량 | 저항 증가, 발열, 손실 증가 | 외관, 소음 |

#### 클램프(CLAMP)

| 기능 | 동사 | 기능 실패 의미 | 허용 고장영향 | 금지 고장영향 |
|-----|-----|--------------|-------------|-------------|
| 권선을 고정한다 | 고정 | 고정 실패 | 권선 이동, 변위, 진동 증가 | 효율, 절연, 과열 |
| 압축력을 유지한다 | 유지 | 압축력 저하 | 이완, 체결 풀림, 갭 발생 | 효율, 절연 |

#### 절연유(INSULATING OIL)

| 기능 | 동사 | 기능 실패 의미 | 허용 고장영향 | 금지 고장영향 |
|-----|-----|--------------|-------------|-------------|
| 절연을 제공한다 | 제공 | 절연 불가 | 절연파괴, 방전, 단락 | 소음, 진동, 외관 |
| 열을 방출한다 | 방출 | 냉각 불가 | 과열, 온도 상승, 열화 | 외관, 접지 |
| 밀봉을 유지한다 | 유지 | 밀봉 실패 | 누유, 유면 저하, 오염 | 효율, 소음 |

### 기능 누락 발견 시 조치

**문제 상황**: 고장영향이 어떤 기능에도 연결되지 않음

```text
예시:
  고장영향 "소음 기준 초과"가 발견됨
  현재 기능: "손실을 최소화한다", "자속을 전달한다"
  → 두 기능 모두 소음과 인과관계 없음!

해결:
  새 기능 추가: "진동을 억제한다"
  → 진동 억제 실패 → 소음 증가 → 소음 기준 초과 [OK]
```

### 검증 체크리스트 (기능 정의 시)

생성한 각 기능에 대해:

- [ ] 기능 동사가 명확한가? (최소화, 전달, 고정, 절연, 지지, 냉각, 밀봉, 접지, 억제, 제공)
- [ ] 해당 기능 실패 시 발생 가능한 고장영향 목록이 있는가?
- [ ] 모든 고장영향이 최소 1개 기능과 인과관계가 있는가?
- [ ] 인과관계 없는 고장영향이 있으면, 새 기능을 추가했는가?

---

## [!!] 기능의 이상 = 고장형태 (CRITICAL - 회의 합의 260109)

> **상세 내용은 [diamond-structure.md](diamond-structure.md#-기능의-이상--고장형태-과부족유해-도출법) 참조**
>
> **핵심 원리**: 고장형태는 "기능이 어떻게 이상해지는가"에서 논리적으로 도출됨

| 분류 | 의미 | 질문 (가이드 V1.3) |
|------|------|------|
| **부족:** | 결과물 미달 | "기능 결과물이 부족하면?" |
| **과도:** | 결과물 초과 | "기능 결과물이 과하면?" |
| **유해:** | 결과물 정상, 부작용 | "기능 결과물 정상인데 부작용?" |

**참조**: [diamond-structure.md](diamond-structure.md) - 상세 예시 및 검증 체크리스트

---

## 주기능과 보조기능

### 구분 기준

| 구분 | 정의 | 특징 |
|------|------|------|
| **주기능** | 부품의 핵심 역할 | 1-2개, 부품 존재 이유 |
| **보조기능** | 부수적 역할 | 1-3개, 부가 가치 |

### [BLOCKING] 다이어그램에서 기능 추출 (필수!)

> **[!!] CRITICAL**: 주기능/보조기능은 반드시 다이어그램에서 추출! 임의 생성 금지!

**다이어그램 파일**:
```
01.회의/00.회의 자료/02.다이어그램_기능분석/변압기_FMEA_Step2_Step3_다이어그램_v2.9_xlsx.json
구조: sheets.기능분석 배열 (326행, Row 3부터 데이터)
용어: 01.회의/00.회의 자료/01.용어정리/변압기_전문용어집_V2.2_xlsx.json
```

**컬럼 구조** (Row 3 헤더):
- **D열**: L2 (도면명) - Excel 파일명/Row 1 제목 (예: "단자 자재표", "철심", "권선")
- **E열**: L3 (부품명) - 개별 부품 (예: "압착단자", "슬리브", "CLAMP")
- **F열**: 기능 ("[목적어]를 [동사]한다" 형식)

### [BLOCKING] 다이어그램 순서 보존 (기능_순서 필드 필수!)

> **[!!] CRITICAL**: 다이어그램 Row 순서 = Excel 기능 순서! 문자열 정렬 금지!

**순서 보존 규칙**:
```
다이어그램 Row 순서:
  Row 53: 기능 1 -> 기능_순서: 1
  Row 54: 기능 2 -> 기능_순서: 2
  Row 55: 기능 3 -> 기능_순서: 3
  ...

JSON 생성 시 반드시 기능_순서 필드 포함!
```

**JSON 구조 예시**:
```json
{
  "fmea_data": [
    {"부품명": "권선", "기능": "전류의 경로를 제공한다", "기능_순서": 1, ...},
    {"부품명": "권선", "기능": "전류를 흘려 자기장을 만든다", "기능_순서": 2, ...},
    {"부품명": "권선", "기능": "자기장을 받아 전압을 발생시킨다", "기능_순서": 3, ...}
  ]
}
```

**[X] 금지 (BLOCKING!)**:
- `기능_순서` 필드 없이 JSON 생성 -> 기능이 문자열 알파벳 순으로 정렬됨!
- 다이어그램 순서 무시하고 임의 순서 부여

**[O] 필수**:
- 다이어그램 Read 시 Row 번호 기록
- JSON 생성 시 `기능_순서` 필드에 다이어그램 Row 순서 반영

**도면명(D열) -> Excel 파일명**:
```
D열 값 = Excel 파일명 = Row 1 제목
예: "단자 자재표" -> "단자 자재표_FMEA.xlsx"
```

**주기능/보조기능 구분 규칙**:
```
각 부품(E열)에 대해:
- 첫 번째 기능(F열) = 주기능
- 두 번째 이후 기능(F열) = 보조기능
```

**추출 예시** (D열: 단자 자재표):
| D열 (도면명) | E열 (부품명) | F열 (기능) | 구분 |
|-------------|-------------|-----------|------|
| 단자 자재표 | 압착단자 | 리드를 단자에 연결한다 | **주기능** |
| | 압착단자 | 전류의 경로를 제공한다 | 보조기능 1 |
| | 압착단자 | 인장력에 버틴다 | 보조기능 2 |
| | 슬리브 | 리드와 리드를 연결한다 | **주기능** |
| | 슬리브 | 전류의 경로를 제공한다 | 보조기능 1 |

**금지 사항**:
- [X] 다이어그램 미확인 후 기능 작성
- [X] "WebSearch로 보조기능 확인 필요" 출력 (다이어그램에 있음!)
- [X] 주기능/보조기능 임의 생성
- [X] D열(도면명) 대신 E열(부품명)을 Excel 파일명으로 사용

### [!!] CRITICAL - FMEA에서 기능 처리 방법

**AIAG-VDA 2019 원칙**: 각 기능(주기능 + 보조기능)은 **별도의 Failure Chain**을 가진다.

```text
[!] 핵심: 주기능과 보조기능 모두 FMEA "기능" 열에 별도 행으로 작성!

[OK] 올바른 FMEA 구조:
┌─────────┬────────────────────────────────┬─────────────┐
│ 부품명  │ 기능                           │ 고장영향... │
├─────────┼────────────────────────────────┼─────────────┤
│ CORE    │ 1차-2차 간 자속을 전달한다     │ (영향1)     │  ← 주기능
│ CORE    │ 와전류 손실을 최소화한다       │ (영향2)     │  ← 보조기능
│ CORE    │ 자기저항을 최소화한다          │ (영향3)     │  ← 보조기능
│ CORE    │ 접지 경로를 제공한다           │ (영향4)     │  ← 보조기능
└─────────┴────────────────────────────────┴─────────────┘

[X] 잘못된 FMEA 구조 (기능 통합):
┌─────────┬────────────────────────────────┬─────────────┐
│ 부품명  │ 기능                           │ 고장영향... │
├─────────┼────────────────────────────────┼─────────────┤
│ CORE    │ 1차-2차 간 자속을 전달한다     │ (모든 영향) │  ← 모든 기능 통합 = 위반!
└─────────┴────────────────────────────────┴─────────────┘
```

**이유**:

- 각 기능별로 고장영향이 다르다 (주기능 실패 vs 보조기능 실패)
- 각 기능별로 고장형태/원인/대책이 다르다
- 기능을 통합하면 위험 시나리오 누락

### 예시 - 클램프

| 기능 유형 | 기능 표현 |
|----------|----------|
| **주기능** | 권선 위치를 고정한다 |
| **보조기능 1** | 진동을 흡수한다 |
| **보조기능 2** | 하중을 분산한다 |

### 예시 - 철심 (CORE)

**[!] 형식 참고용 예시 - 실제 FMEA 생성 시 WebSearch 결과 사용!**

| 기능 유형 | 기능 표현 |
|----------|----------|
| **주기능** | 1차-2차 간 자속을 전달한다 |
| **보조기능 1** | 자기저항(Reluctance)을 최소화한다 |
| **보조기능 2** | 와전류 손실을 최소화한다 |

### 예시 - 절연유

| 기능 유형 | 기능 표현 |
|----------|----------|
| **주기능** | 전기적 절연을 제공한다 |
| **보조기능 1** | 열을 방출한다 |
| **보조기능 2** | 부품 산화를 방지한다 |

---

## 부품별 기능 예시

> **[!!] 경고: 아래 예시는 형식 참고용입니다! 실제 FMEA 생성 시 내부문서 + WebSearch 결과 사용!**

### 중신 (Core Assembly)

| 부품명 (A열) | 주기능 (B열) | 보조기능 |
|------|--------|---------|
| CORE (철심) | 1차-2차 간 자속을 전달한다 | 자기저항을 최소화한다 / 와전류를 최소화한다 |
| LOW_CLAMP | 권선 위치를 고정한다 | 진동을 흡수한다 |
| BASE_BRACKET | 철심 구조를 지지한다 | 하중을 분산한다 |
| TANK_SUPPORT | 탱크 하중을 지지한다 | 충격을 흡수한다 |

### 권선 (Winding)

| 부품명 (A열) | 주기능 (B열) | 보조기능 |
|------|--------|---------|
| HV_WINDING | 고압 전력을 변환한다 | 임피던스를 제공한다 |
| LV_WINDING | 저압 전력을 출력한다 | 단락 전류를 제한한다 |
| R-SPACER | 냉각 통로를 확보한다 | 절연 거리를 유지한다 |
| INSULATION | 층간 절연을 제공한다 | 열을 차단한다 |

### 단자 (Bushing/Terminal)

| 부품명 (A열) | 주기능 (B열) | 보조기능 |
|------|--------|---------|
| HV_BUSHING | 외부와 내부를 전기적으로 연결한다 | 절연을 유지한다 |
| LV_BUSHING | 저압 출력을 외부로 전달한다 | 기밀을 유지한다 |
| TERMINAL | 외부 케이블을 연결한다 | 접촉 저항을 최소화한다 |

### 외함 (Tank)

| 부품명 (A열) | 주기능 (B열) | 보조기능 |
|------|--------|---------|
| TANK | 절연유를 담는다 | 외부 환경을 차단한다 |
| GASKET | 기밀을 유지한다 | 오일 누출을 방지한다 |
| CONSERVATOR | 유면 변화를 수용한다 | 수분 침입을 방지한다 |

---

## 기능분석 시트 권장안

### 별도 "기능분석" 시트 생성 (권장)

**이유**: AIAG-VDA 7-Step에서 Step 2(구조)와 Step 3(기능)은 별도 단계

### 시트 구조 예시

```text
| 구분 | 파트명 | 주기능 | 보조기능 | 관련 고장형태 | 고장영향 |
|------|--------|--------|---------|---------------|----------|
| 중신 | LOW_CLAMP_LV | 권선 위치를 고정한다 | 진동을 흡수한다 | 변형, 이완 | 권선 이동 |
| 중신 | BASE_BRACKET | 철심 구조를 지지한다 | 하중을 분산한다 | 좌굴, 파손 | 구조 붕괴 |
| 권선 | R-SPACER | 냉각 통로를 확보한다 | 절연 거리 유지 | 변형, 탈락 | 냉각 불량 |
```

### 기존 구성품.xlsx에 추가하는 경우

**위치**: 변압기 구성품.xlsx에 "기능분석" 시트 추가

**연결**: 중신/권선/단자/외함 시트의 파트와 연결

---

## 기능분석 데이터 생성 워크플로우 (WebSearch 기반)

### [!] CRITICAL - 모든 데이터 하드코딩 금지

**잘못된 방식**: 구분/주기능/보조기능을 템플릿에서 고정값으로 가져옴

**올바른 방식**: 모든 데이터를 내부 문서 + WebSearch 기반으로 동적 생성

| 열 | 데이터 소스 | 하드코딩 |
|----|------------|---------|
| **구분** | 내부문서(구성품.xlsx) 또는 WebSearch | [X] 금지 |
| **주기능** | WebSearch + 내부문서 | [X] 금지 |
| **보조기능** | WebSearch + 내부문서 | [X] 금지 |
| **관련 고장형태** | FMEA 분석 결과 | [OK] FMEA에서 추출 |
| **고장영향** | FMEA 분석 결과 | [OK] FMEA에서 추출 |

### Step 1 - 내부 문서 확인

**Glob 검색** (상대경로):

```text
**/변압기 구성품.xlsx             ← 구분(중신/권선/단자/외함) 정보 확인
**/02.CHECK SHEET/*.*             ← 설계 CHECK SHEET
**/03.Work Flow Sheet/*.*         ← 설계 Work Flow
**/생산 작업요령/*.*              ← 생산 작업요령
**/검사/공정/*.*                  ← 공정검사 요령
**/검사/수입/*.*                  ← 수입검사 요령
**/97.도시바TD/TD*/IJTD_*.pdf     ← 도시바 기술문서 (IJTD 개별 파일)
**/04.프로젝트 도면/**/*.*        ← 프로젝트 도면
```

> **[!] TD 시리즈 IJTD 파일 구조**:
> - 파일명 형식: `97.도시바TD/TD{번호}/IJTD_{번호}_REV{버전}.pdf`
> - 예: `97.도시바TD/TD4/IJTD_4143_REV0.0.pdf`
> - 부품별 필수 IJTD는 `mandatory_docs_by_component.json` 참조
> - 상세: [internal-docs-index.md](internal-docs-index.md) TD Series 섹션

**[FOLDER] 지원 파일 형식**: Excel(`.xlsx`) > Word(`.docx`) > PPT(`.pptx`) > PDF(`.pdf`)

**추출 정보**:

| 문서 유형 | 추출 정보 | 기능분석 활용 |
|----------|----------|--------------|
| **구성품.xlsx** | 시트 위치(중신/권선/단자/외함) | **구분** 열 |
| **CHECK SHEET** | 설계 검토 항목 | 주기능/보조기능 확인 |
| **Work Flow Sheet** | 설계 공정 흐름 | 기능 관계 파악 |
| **생산 작업요령** | 작업 기준, 품질 요건 | 기능 요구사항 |
| **검사 요령** | 검사 항목, 판정 기준 | 기능 검증 방법 |
| **도시바TD** | 기술 사양 | 기능 상세 정의 |

**[!] 파일 오류 시**: PDF 오류 발생하면 Excel/Word/PPT 먼저 검색 → 없으면 WebSearch로 대체

### Step 2 - WebSearch 실행

**필수 검색 (부품별)**:

```text
WebSearch: "{부품명} transformer function purpose design"
WebSearch: "{부품명} 변압기 기능 역할"
WebSearch: "IEC 60076 {부품명} requirements"
```

**검색 결과에서 추출**:

- 부품의 주요 역할 (주기능)
- 부수적 역할 (보조기능)
- 설계 요구사항에서 파생된 기능

### Step 3 - 기능 표현 변환

**WebSearch 결과 → 기능 표현 형식 변환**:

| WebSearch 결과 | 부품명 (A열) | 기능 (B열) |
|---------------|-------------|-----------|
| "core supports windings structurally" | CORE | 권선을 기계적으로 지지한다 |
| "spacer maintains cooling channel" | R-SPACER | 냉각 통로를 확보한다 |
| "clamp absorbs vibration" | CLAMP | 진동을 흡수한다 |

### Step 4 - 검증

**품질 체크**:

- [ ] WebSearch 출처가 명시되어 있는가?
- [ ] "[목적어]를 [동사]한다" 형식인가? (주어 생략)
- [ ] 주기능과 보조기능이 구분되어 있는가?

---

## 품질 체크리스트

### 기능 표현 검증

- [ ] "[목적어]를 [동사]한다" 형식인가? (주어는 A열 부품명 참조)
- [ ] 주기능이 명확히 정의되었는가?
- [ ] 보조기능이 WebSearch/내부문서 기반으로 생성되었는가?
- [ ] 기능과 고장형태가 연결되었는가?

### 기능 분석 검증

- [ ] WebSearch에서 발견된 주요 기능을 사용했는가?
- [ ] 억지로 기능 개수를 맞추지 않았는가?

### 금지 사항

- [X] 명사형만 사용 ("고정", "전달", "지지")
- [X] 목적어 없는 표현 ("고정한다")
- [X] 주어 반복 ("철심이 자속을 전달한다" → "자속을 전달한다"로 수정)

---

**참고**:

- 회의 합의 (2025.11.28): 기능 분석 Step 명확화
- AIAG-VDA 2019 Handbook - Step 3: Function Analysis
