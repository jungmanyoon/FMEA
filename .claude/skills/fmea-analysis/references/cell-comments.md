# FMEA Excel 입력 안내 메시지 (Data Validation Messages) 정의

**목적**: Row 6 헤더 셀에 자동 추가되는 작성 가이드 메시지 정의

**적용**: `scripts/generate_fmea_excel.py`의 `add_cell_validation_messages()` 함수에서 참조

**기준**: AIAG-VDA 2019, column-details.md, sod-criteria.md

**방식**: 데이터 유효성 검사 (DataValidation) - M365 웹에서도 표시됨

---

## 메시지 스타일 가이드

**제한 사항**:
- promptTitle: 최대 32자
- prompt: 최대 255자 (핵심 내용만 압축)

**표시 방식**: 셀 클릭 시 팝업으로 표시 (레거시 메모와 다름)

**호환성**:
- [O] Excel 데스크톱: 지원
- [O] M365 웹: 지원 (레거시 메모는 미지원)
- [O] Excel Online: 지원

**언어**: 한국어
**형식**: 간결한 불릿 포인트, 예시 포함 (255자 이내)

---

## 현재 상태 (1-13번 컬럼)

### A6 - 부품명

```
부품 이름만 작성 (번호 금지)
[X] "1. CORE" [O] "CORE"
예: CORE, WINDING, TAP_CHANGER
```

### B6 - 기능

```
부품의 기능 (3-10개, 번호 금지)
[X] "기능1: 자속전달" [O] "자속전달"
예: 자속전달, 효율최대화, 기계적지지
```

### C6 - 고장영향

```
[미래] 발생할 수 있는 결과 (고객 인식)
옵션A: [영향]\n([설명])
예: 전압 변환 불가
    전압 변환 불가\n(자속 밀도 저하로 2차측 출력 불가)
[O] 진동, 소음, 화재, 오작동, 동작불가
[X] FAT불합격/조립불합격 -> 검사결과!
[X] 와전류증가 -> G열 (메커니즘)
```

### D6 - S (심각도)

```
심각도 (1-10)
10: 송전마비/화재  9: 작동불능
7-8: 성능저하  5-6: 소음/진동
3-4: 외관문제  1-2: 경미
```

### E6 - 고장형태

```
[현재] 시각적으로 관찰된 현상
[*]3줄 구조 필수:
1줄: 부족: 현상 (또는 과도: / 유해:)
2줄: (상세 설명)
3줄: (태그 판단 근거)
예: 부족: 적층이완
    (철심 판의 누적 팽창)
    (부족: 전달된 자속이 부족하면 이완)
[O] 변형,크랙,부식,이완,누유
[X] 소음/진동->C열, ~증가->G열
```

### F6 - 고장원인

```
형식: 단계: 원인 (문서번호)
단계: 설계/재료/제작/시험
옵션A: 단계: [원인]\n([설명])
예: 제작: 압착력 부족
    제작: 압착력 부족\n(목표 2500kN에 1800kN 미달)
* 작업표준(W시리즈) 기준 역해석
```

### G6 - 고장메커니즘

```
형식: 원인->과정->결과
예: 절연열화->층간단락->와전류증가
    적층불량->손실증가->국부과열
* WebSearch 기반 물리적 메커니즘
```

### H6 - 현재예방대책

```
형식: 단계: 대책내용 (기준/표준)
단계: 설계/재료/제작/시험
예: "설계: 허용응력 검토 (CHECK SHEET)"
    "제작: 압착력 관리 (2500kN+-10%)"
    "재료: 코팅두께 검증 (>=2um)"
```

### I6 - O (발생도)

```
발생도 (1-10), 연200대 기준
10:>=5대/년 9:4대 8:3대 7:2대
6:1대/년 5:1대/2년 4:1대/5년
3:1대/10년 2:1대/50년 1:발생불가
```

### J6 - 현재검출대책

```
형식: 단계: 검출방법 (장비/문서번호)
단계: 설계/재료/제작/시험
예: "설계: 설계 검토 (Design Review)"
    "재료: 내전압시험 (IEQT-T-R012)"
    "제작: 이물질검사 (IEQT-T-I007)"
    "시험: 무부하손측정 (IEQT-T-P005)"
```

### K6 - D (검출도)

```
검출도 (1-10), 낮을수록 우수
10:검출불가 9:특수장비 8-7:PD/DGA
6:FAT 5:정밀측정 4:일반측정
3:자동검사 2:숙련육안 1:명확육안
```

### L6 - RPN (위험 우선순위 번호)

```
RPN = S x O x D (1-1000)
빨강: >=200 노랑: 100-199 녹색: <100
예: S9xO4xD7=252(빨강)
* 자동계산, 개선율 측정용
```

### M6 - AP (조치 우선순위)

```
AP (H/M/L) 자동계산
H: S>=9 OR (S>=7 AND O>=7) OR (S>=7 AND D>=7)
M: S>=7 OR (S>=5 AND O>=5) OR (S>=5 AND D>=5)
H:즉시 M:3개월 L:6개월
```

---

## 조치 계획 (14-17번 컬럼)

### N6 - 예방조치

```
계획된 예방 조치
H: 설계변경/재료개선/공정변경
M: 검증추가/기준수립/교육강화
L: 없음 또는 검토중
* 항목별 다른 대책 필수
```

### O6 - 검출조치

```
계획된 검출 조치
H: FAT/SAT추가, 특수장비 도입
M: 검사기록의무화, 측정정밀도향상
L: 없음 또는 검토중
* 항목별 다른 대책 필수
```

### P6 - 담당자

```
책임팀 (고장원인 단계별)
설계->전기/구조설계팀
재료->구매팀/QA팀
제작->생산팀 시험->QA팀
```

### Q6 - 목표일

```
대책 완료 목표 (AP 기반)
H: 즉시
M: 3개월
L: 6개월
```

---

## 개선 후 (18-22번 컬럼)

### R6 - S' (개선 후 심각도)

```
대책 후 심각도
기본: S와 동일 (변경 불가)
예외: 설계변경시 감소 가능
예: 폭발방지장치->S10->S'8
```

### S6 - O' (개선 후 발생도)

```
대책 후 발생도 (초기: O-1)
H: 감소>=2 M: 감소>=1 L: 0-1
예: O8->O'6 (예방강화)
    O5->O'4 (기준수립)
```

### T6 - D' (개선 후 검출도)

```
대책 후 검출도 (초기: D-1)
H: 감소>=2 M: 감소>=1 L: 0-1
예: D9->D'7 (FAT추가)
    D6->D'4 (자동검사)
```

### U6 - RPN' (개선 후 RPN)

```
RPN' = S' x O' x D'
빨강:>=200 노랑:100-199 녹색:<100
개선율=(RPN-RPN')/RPN x100%
예: 252->36 = 85.7% 개선
```

### V6 - AP' (개선 후 우선순위)

```
S',O',D' 기반 재계산
목표: H->M/L, M->L
H(빨강):추가대책 M(노랑):모니터링
L(녹색):적정수준
```

---

## 메시지 적용 규칙

### 1. 메시지 제한
- **promptTitle**: 최대 32자 (컬럼 제목 요약)
- **prompt**: 최대 255자 (핵심 내용만)
- **초과 시**: 자동 잘림, 내용 압축 필수

### 2. 메시지 형식
- **불릿 포인트**: - 기호 사용 (이모지 금지)
- **줄바꿈**: \n 사용
- **강조**: [주의], [X], [O] 텍스트 사용 (이모지 사용 금지 - Excel 호환성)

### 3. 적용 위치
- **대상**: Row 6 헤더 셀 (A6-V6)
- **타이밍**: Excel 생성 시 자동 추가
- **사용자 경험**: 셀 클릭 시 팝업으로 표시

### 4. 호환성 비교
| 항목 | 레거시 메모 (Comment) | 입력 안내 메시지 (DataValidation) |
|------|----------------------|-----------------------------------|
| Excel 데스크톱 | O | O |
| M365 웹 | X | O |
| 표시 방식 | 마우스 오버 | 셀 클릭 |
| 크기 제한 | 없음 | 255자 |
| 노란 바탕 | O | X (흰 팝업) |

---

## 품질 기준

### 필수 요소
- [O] AIAG-VDA 2019 표준 준수
- [O] column-details.md 내용 일치
- [O] sod-criteria.md 평가 기준 반영
- [O] 예시 포함 (실제 사용 가능)

### 금지 요소
- [X] 불필요한 장황함 (간결성 최우선)
- [X] 모호한 표현 (구체적 수치 제시)
- [X] 표준 위배 내용
- [X] 실무 적용 불가 예시
- [X] 이모지 사용 (Excel 파일 손상 원인)

---

## 참고 문서

**기준 문서**:
- [column-details.md](column-details.md): 컬럼 상세 설명
- [sod-criteria.md](sod-criteria.md): S/O/D 평가 기준
- [quality-examples.md](quality-examples.md): 품질 예시

**적용 스크립트**:
- [scripts/generate_fmea_excel.py](../scripts/generate_fmea_excel.py): Excel 생성 및 메모 추가

---

## 버전 관리

**최초 작성**: 2025-01-25
**작성자**: FMEA 스킬 개발팀
**버전**: 3.6
**변경 이력**:
- v1.0: 초기 버전 (레거시 메모 Comment 방식)
- v2.0: 데이터 유효성 검사 메시지 (DataValidation) 방식으로 변경 - M365 웹 호환
- v3.0: Single Source of Truth 지정 - generate_fmea_excel.py에서 자동 파싱 (2026-01-09)
- v3.1: 이모지 제거 - Excel 파일 손상 방지 (2026-01-10)
  - 모든 이모지를 텍스트로 대체: [O], [X], [!], [주의], [금지]
  - 불릿 포인트 통일: - (하이픈)
  - 화살표 통일: -> (ASCII)
- v3.2: 22개 컬럼으로 확장 - RPN 추가 (2026-01-10)
  - RPN (L열), AP (M열로 이동)
  - RPN' (U열), AP' (V열로 이동)
  - 컬럼 범위: A-T → A-V
- v3.3: 메시지 압축 - 팝업 표시 최적화 (2026-01-10)
  - 모든 22개 컬럼 메시지를 4-6줄로 압축
  - Excel 팝업 높이 제한 대응
- v3.4: 고장영향/고장형태 구분 명확화 (2026-01-11)
  - C6 고장영향: [미래] 발생할 수 있는 결과
  - E6 고장형태: [현재] 시각적으로 관찰된 현상
- v3.5: sod-criteria.md/회의록 일치화 (2026-01-11)
  - I6 O=2: 1대/25년 -> 1대/50년 (sod-criteria 기준)
  - K6 D=9: SAT후 -> 특수장비 (모호함 제거)
  - M6 AP: 논리 연산자 명확화 (AND/OR)
- v3.6: QA 자료 내부문서 연계 강화 (2026-01-18)
  - F6 고장원인: 문서번호 형식 추가 (IEQT-T-W### 참조)
  - J6 검출대책: 검사기준 형식 추가 ([시점]: 방법 (IEQT-T-R/I/P###))
  - 작업표준/검사기준 연계 강조
- v3.7: F/H/J열 단계 태그 통일 (2026-01-27)
  - H6 예방대책: 단계: 형식 추가 (설계/재료/제작/시험)
  - J6 검출대책: [시점] -> [단계] 형식 변경 (설계/재료/제작/시험)

---

## Single Source of Truth 정책

**이 파일이 Row 6 메시지의 단일 진실 원천입니다.**

- `scripts/generate_fmea_excel.py`의 `load_cell_comments()` 함수가 이 파일을 파싱
- 이 파일 수정 시 Excel 생성에 자동 반영
- 다른 파일에 중복 정의 금지

**파싱 규칙**:
- `### [A-V]6 - [제목]` 형식의 헤더로 컬럼 구분
- 헤더의 제목 -> promptTitle (32자 제한)
- 코드 블록 (```) 내용 -> prompt (255자 제한)
