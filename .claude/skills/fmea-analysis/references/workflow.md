# FMEA 작성 워크플로우 상세 가이드

**4단계 프로세스**: STEP 0 (다이어그램) -> STEP 1 (내부문서 + WebSearch) -> STEP 2 (FMEA 생성) -> STEP 3 (Excel 생성)

[!] **CRITICAL: 다이어그램 먼저, 내부문서 Read 후 WebSearch, 페르소나 분석은 GATE 1/2/3에서 자동 수행!**

---

## 0단계: 내부 문서 분석 (MUST - 있는 경우)

### [BLOCKING] Read-Write 동기화 프로토콜

> **[!!] 핵심 원칙: 문서 Read 직후 즉시 해당 H/J열 작성!**
> 상세: [anti-hallucination.md](anti-hallucination.md) PRIMARY 원칙 참조

**[X] 금지 (날조 발생!)**
```
CHECK SHEET Read -> 작업표준 Read -> 시험요령 Read -> [나중에] H/J열 한꺼번에 작성
```

**[O] 필수 (동기화 패턴)**
```
1. 설계 문서 Read (CHECK SHEET, WORKFLOW, DRAWING, TD)
   -> [즉시] H/J열 "설계:" 단계 작성

2. 제작 문서 Read (W시리즈, I시리즈, C시리즈)
   -> [즉시] H/J열 "제작:" 단계 작성

3. 시험 문서 Read (P시리즈)
   -> [즉시] H/J열 "시험:" 단계 작성

4. 재료 문서 Read (R시리즈)
   -> [즉시] H/J열 "재료:" 단계 작성
```

### [BLOCKING] 강제 파일 읽기 프로토콜

> **[!!] 인덱스만 보고 유추 금지! 실제 파일을 Read tool로 읽어야 함!**

**1단계: 인덱스에서 파일 경로 추출**
```
Read: 02.참고자료/_fmea_index/mandatory_docs_by_component.json (v4.0)
-> categories.{카테고리}.{도면명}.{부품명} 섹션 찾기
-> mandatory_docs.design[].file, manufacturing[].file, testing[].file 경로 추출
-> 모든 경로는 _converted/ 하위 텍스트 파일 (MD/JSON)
```

**2단계: 추출된 파일 실제 Read + 즉시 작성 (건너뛰기 금지!)**
```
[X] 금지: 인덱스 메타데이터만 보고 FMEA 유추 작성
[X] 금지: 모든 파일 Read 후 나중에 H/J열 한꺼번에 작성
[OK] 필수: 파일 Read -> 즉시 해당 라이프사이클 H/J열 작성 -> 다음 파일
[!] 경로: 02.참고자료/{file경로}
```

### [SEARCH] 내부 문서 검색 (2단계 Progressive Disclosure)

**1. 인덱스 먼저 확인 (v4.0)**:
```
Read: 02.참고자료/_fmea_index/mandatory_docs_by_component.json
-> categories.{카테고리}.{도면명}.{부품명}.mandatory_docs 확인
-> design[], manufacturing[], testing[] 각 배열에서 file 경로 추출
```
> **핵심**: 시리즈 구분 없이 **부품 관련 모든 문서 검색!**
- v4.0 인덱스가 3단계 폴백으로 모든 관련 문서를 자동 매핑
- CHECK/WORKFLOW (카테고리 상속) + W/I/P (시리즈 상속) + 부품별 매칭

**2. 인덱스에서 찾은 변환 파일 Read**:
```
Read: 02.참고자료/{file경로}
-> file 경로는 _converted/ 하위 텍스트 파일 (MD 또는 JSON)
-> 바이너리 원본이 아닌 변환된 텍스트 파일 Read!
```

### [REF] 내부 문서에서 추출할 정보

> **핵심**: 시리즈 구분 없이 **인덱스에서 부품 관련 모든 문서 검색!**

| 정보 유형 | 문서 예시 (시리즈 제한 없음) | FMEA 활용 컬럼 |
|----------|--------------------------|---------------|
| 재질/규격 | TD시리즈, CHECK SHEET, WFS | F열 (고장원인) |
| 작업 기준 | W시리즈, **C시리즈**, I시리즈 | F열 (제작 고장원인) |
| 검사 기준 | R/I/P시리즈, CHECK SHEET | J열 (검출대책), D값 |
| 토크 기준 | **C시리즈** (C006 등) | F열 (이완 고장원인) |
| 이물질 기준 | I시리즈, **C시리즈** | S값, D값 |

### FMEA 컬럼별 필수 내부 문서 매핑

> **핵심**: C~J열 모두 **인덱스에서 부품 관련 모든 문서 검색** (시리즈 제한 없음!)

| FMEA 컬럼 | 문서 예시 (시리즈 제한 없음) | Read 필수 |
|-----------|--------------------------|----------|
| **B열 (기능)** | 기능분석 다이어그램 F열 | **[BLOCKING]** |
| **C열 (고장영향)** | QA DB + CHECK SHEET | O |
| **E열 (고장형태)** | CHECK SHEET + QA DB + TD시리즈 + 모든 관련 문서 | O |
| **F열 (고장원인)** | W시리즈 + QA DB + TD시리즈 + **C시리즈** + 모든 관련 문서 | O |
| **G열 (메커니즘)** | TD시리즈 + WebSearch + 모든 관련 문서 | O |
| **H열 (예방대책)** | CHECK SHEET + W시리즈 + QA DB + **C시리즈** + 모든 관련 문서 | O |
| **J열 (검출대책)** | R/I/P시리즈 + QA DB + **C시리즈** + 모든 관련 문서 | O |

### [FOLDER] 내부 문서 분석 결과 (출력 형식)

```
## [FOLDER] 내부 문서 분석 결과

### Read 기록
| 문서 유형 | 파일명 | Read 상태 | 추출 정보 |
|----------|--------|----------|----------|
| 인덱스 | FMEA_부품별_참고자료_인덱스.json | O | 관련 파일 5개 |
| CHECK SHEET | 중신 CHECK SHEET_24_R02.xlsm | O | 검증항목 12개 |
| W시리즈 | IEQT-T-W018 | O | 관리기준 8개 |
| TD시리즈 | IJTD_4143_REV0.0.pdf | O | 바인딩 기준 |

### 참조 문서
| 문서번호 | 문서명 | 추출 정보 |
|----------|--------|----------|
| TD4 | 철심 체결 | 바인딩 압력 기준, 온도상승 계산식 |
| W018 | 철심조립 작업요령 | 적층 순서, 클램프 체결 기준 |

### 추출 데이터
| 항목 | 값 | FMEA 활용 |
|------|-----|----------|
| 클램프 볼트 토크 | M12: 85Nm | F열 고장원인 (이완) |
| 적층 공차 | ±0.5mm | D값 근거 |
```

**내부 문서 없는 경우**: "내부 문서 없음, WebSearch만으로 진행" 명시 후 1단계로 이동

---

## [BLOCKING] 다이어그램에서 기능 추출 (주기능/보조기능)

> **[!!] CRITICAL**: FMEA B열(기능)과 기능분석 시트의 주기능/보조기능은 반드시 다이어그램에서 추출!

### 다이어그램 파일

```
파일: 01.회의/00.회의 자료/02.다이어그램_기능분석/변압기_FMEA_Step2_Step3_다이어그램_v2.9_xlsx.json
구조: sheets.기능분석 배열 (326행)
용어: 01.회의/00.회의 자료/01.용어정리/변압기_전문용어집_V2.2_xlsx.json (304개 표준 용어)
```

### 기능 추출 규칙

**컬럼 구조** (Row 3 헤더):
- **D열**: L2 (도면명) - Excel 파일명/Row 1 제목 (예: "단자 자재표", "철심", "권선")
- **E열**: L3 (부품명) - 개별 부품 (예: "압착단자", "슬리브", "CLAMP")
- **F열**: 기능 ("[목적어]를 [동사]한다" 형식)

**도면명(D열) -> Excel 파일명/Row 1 제목**:
```
[규칙] D열 값 = Excel 파일명 = Row 1 제목
예: D열 "단자 자재표" -> "단자 자재표_FMEA.xlsx" -> Row 1: "단자 자재표_FMEA"
```

**주기능/보조기능 구분**:
```
[규칙] 각 부품(E열)에 대해:
- 첫 번째 기능(F열) = 주기능
- 두 번째 이후 기능(F열) = 보조기능
```

### 추출 예시 (D열: 단자 자재표)

| D열 (도면명) | E열 (부품명) | F열 (기능) | 구분 |
|-------------|-------------|-----------|------|
| 단자 자재표 | 압착단자 | 리드를 단자에 연결한다 | **주기능** |
| | 압착단자 | 전류의 경로를 제공한다 | 보조기능 1 |
| | 압착단자 | 인장력에 버틴다 | 보조기능 2 |
| | 슬리브 | 리드와 리드를 연결한다 | **주기능** |
| | 슬리브 | 전류의 경로를 제공한다 | 보조기능 1 |

### [BLOCKING] 금지 사항

- [X] 다이어그램 미확인 후 기능 작성
- [X] "WebSearch로 보조기능 확인 필요" 출력 (다이어그램에 있음!)
- [X] 주기능/보조기능 임의 생성
- [X] D열(도면명) 대신 E열(부품명)을 파일명으로 사용

### JSON/Excel 출력 시 필수 포함

```json
{
  "project_info": {
    "도면명": "단자 자재표"  // <- D열에서 추출! Excel 파일명/Row 1 제목
  },
  "fmea_data": [
    {
      "부품명": "압착단자",      // <- E열에서 추출
      "기능": "리드를 단자에 연결한다",  // <- F열에서 추출 (주기능)
      "보조기능": "전류의 경로를 제공한다 / 인장력에 버틴다",  // <- F열에서 추출
      ...
    }
  ]
}
```

**Excel 생성 결과**:
- 파일명: `단자 자재표_FMEA.xlsx` (D열 값 + "_FMEA")
- Row 1: `단자 자재표_FMEA` (D열 값 + "_FMEA")

---

## GATE 0: 내부 문서 Read 검증 (WebSearch 전 필수!)

> **[BLOCKING]** 아래 체크리스트 미충족 시 1단계(WebSearch) 진행 금지!

### [NEW] 필수 문서 체크리스트 시스템 (mandatory_docs)

> **핵심 원칙**: 검색이 아닌 **강제 체크리스트**로 사용!

**1단계: mandatory_docs 조회 (v4.0)**
```
Read: 02.참고자료/_fmea_index/mandatory_docs_by_component.json
-> categories.{카테고리}.{도면명}.{부품명}.mandatory_docs 확인
-> design[], manufacturing[], testing[] 각 배열의 file 경로 추출
```

**2단계: 필수 문서 Read (건너뛰기 금지!)**
| 단계 | 문서 유형 | Read 필수 |
|------|----------|----------|
| design (설계) | CHECK, WORKFLOW, C | [BLOCKING] critical 필수 |
| material (재료) | R, C | [BLOCKING] critical 필수 |
| manufacturing (제작) | W, I | [BLOCKING] critical 필수 |
| testing (시험) | P, I | [BLOCKING] critical 필수 |

**3단계: Read 완료 체크**
```
[CHECKLIST] 필수 문서 Read 상태:
  [O] [design] 중신 CHECK SHEET_24_R02.xlsm (critical)
  [O] [design] IJTD_4396_REV0.0.pdf (high)
  [X] [manufacturing] IEQT-T-W002_용접절차서_*.docx (high) <- 누락!
```

---

```
## [DATA] GATE 0 체크포인트

### [NEW] mandatory_docs 필수 Read 항목
| 항목 | 상태 | 비고 |
|------|------|------|
| mandatory_docs JSON Read 완료 | O/X | 부품별 필수 문서 목록 확인 |
| design 단계 critical 문서 Read | O/X | CHECK SHEET, WORKFLOW 등 |
| material 단계 critical 문서 Read | O/X | R시리즈 (수입검사) |
| manufacturing 단계 critical 문서 Read | O/X | W시리즈 (작업표준) |
| testing 단계 critical 문서 Read | O/X | P시리즈 (시험요령) |

### 필수 Read 항목 (기존)
> **핵심**: 시리즈 구분 없이 **인덱스에서 부품 관련 모든 문서 검색!**

| 항목 | 상태 | 비고 |
|------|------|------|
| 인덱스 JSON Read 완료 | O/X | 관련 파일 목록 확인 |
| CHECK SHEET Read 완료 (부품별 1개 이상) | O/X | 검증항목 추출 |
| 부품 관련 모든 문서 Read 완료 | O/X | W/R/I/P/C/TD시리즈 등 **시리즈 제한 없음!** |
| 도시바TD IJTD Read 완료 (부품별 필수 파일) | O/X | 설계기준 추출 |
| Read 기록 테이블 작성 완료 | O/X | 위 템플릿 사용 |

### 컬럼별 내부문서 커버리지
> **핵심**: C~J열 모두 **인덱스에서 부품 관련 모든 문서 검색** (시리즈 제한 없음!)

| FMEA 컬럼 | 내부문서 출처 (시리즈 제한 없음) | 상태 |
|-----------|----------------------------|------|
| B열 (기능) | 기능분석 다이어그램 | O/X |
| C열 (고장영향) | QA DB / CHECK SHEET / 모든 관련 문서 | O/X |
| E열 (고장형태) | CHECK SHEET / QA DB / 모든 관련 문서 | O/X |
| F열 (고장원인) | 모든 관련 문서 (W/TD/C시리즈 등) | O/X |
| H열 (예방대책) | 모든 관련 문서 (CHECK SHEET/W/C시리즈 등) | O/X |
| J열 (검출대책) | 모든 관련 문서 (R/I/P/C시리즈 등) | O/X |

[BLOCKING] 통과 조건:
- mandatory_docs 5개 항목 모두 O (신규!)
- 필수 Read 5개 모두 O (기존)
- 컬럼별 커버리지 4개 이상 O (기존)
```

---

## GATE 1/2/3: Incremental Validation (스크립트 기반)

> **[!] Claude 자가검증 테이블 삭제됨** - 스크립트 검증 결과만 인정!
> LLM 자가검증은 근본적으로 신뢰할 수 없음 (Self-Validation Gap)

### Real-Time Incremental Validation 워크플로우

```
STEP 2 워크플로우:
==================
10개 생성 -> validate_fmea_json.py 실행 -> 오류 시 수정 -> 재검증
   |
   v
[BATCH 1 통과] -> 10개 더 생성 -> 즉시 검증 -> 수정
   |
   v
[GATE 1: 20개 완료] (스크립트 이미 검증 완료)
   |
   v
10개 생성 -> 즉시 검증 -> 10개 더 생성 -> 검증
   |
   v
[GATE 2: 40개 완료] (스크립트 이미 검증 완료)
   |
   v
[GATE 3: 최종 확인] + 페르소나 분석
```

### 검증 명령어

```bash
# 10개 생성 후 즉시 실행!
python validate_fmea_json.py {부품명}_FMEA_input.json
```

### 스크립트 검증 항목 (validate_fmea_json.py)

| 컬럼 | 검증 내용 |
|------|----------|
| E열 | 태그 필수 + 메커니즘 금지어 |
| C열 | 물리적 상태 금지어 |
| F열 | 라이프사이클 태그 필수 |
| G열 | 화살표(->) 2개 이상 |
| H열 | 4줄 이상 + 기준값 + 태그 2개 이상 |
| J열 | 4줄 이상 + 합격기준 + 태그 2개 이상 |

### GATE 출력 형식 (간소화)

```
## [GATE 1] 20개 항목 완료

### Incremental Validation 결과
- 배치 1 (1-10): [O] 통과 / 수정 2건
- 배치 2 (11-20): [O] 통과 / 수정 1건

### 다이아몬드 구조
- 형태당 원인 평균: 2.5개 (>=2 필수)

[AUTO] GATE 1 완료 -> 계속 진행
```

### GATE 3: 페르소나 분석 (필수 출력!)

```
## [GATE 3] 완료 + 페르소나 분석

### Incremental Validation 최종 결과
- 총 배치: 4개 / 수정 건수: 5건 / 최종 통과

### 페르소나 분석
1. 신뢰성 엔지니어: S>=8 치명적 고장형태 __개 / S값 적절성 O/X
2. FMEA 방법론 전문가: 라이프사이클 균형 O/X (설계/재료/제작/시험 각 15%+)
3. 유지보수 전문가: 예방/검출 실무 적용성 O/X
4. Facilitator: 용어 통일, 문서 정합성 O/X

[AUTO] GATE 3 완료 -> JSON 생성 진행
```

### [X] 금지 사항

- Claude "100% O" 자가검증 출력 (스크립트 결과만 인정!)
- 스크립트 FAIL 상태에서 다음 단계 진행
- "JSON 생성 시 적용" 표현 사용

---

## 1단계: WebSearch 보완 (내부문서에 없는 정보)

### 핵심 원칙

**WebSearch 결과에서 나오는 고장 형태/원인만 사용**
- [OK] 표준/문헌에 실제 존재하는 항목만
- [OK] 실제 고장 사례 기반
- [X] 억지로 개수 맞추기 금지
- [X] 비현실적 시나리오 배제

### 생성 프로세스

```
1단계: WebSearch 5개 출처 검색 (2단계 참조)
  ↓
2단계: 검색 결과에서 고장 형태/원인 추출
  - IEC 표준: 고장 형태 정의, 설계 기준
  - IEEE 표준: 고장 분석 방법, 검출 대책
  - CIGRE: 통계 데이터, 발생 빈도
  - Transformer Magazine: 실제 사례, 근본 원인
  - 일반 검색: 최신 사례, 실무 지식
  ↓
3단계: Failure Chain 구조로 조합
  기능 (3-5개) → 고장영향 (각 2개) → 고장형태 (각 3개) → 고장원인 (각 3개)
  예: 3 기능 × 2 영향 × 3 모드 × 3 원인 = 54개
  ↓
4단계: 자연스럽게 결정됨 (품질 우선, 개수 제한 없음)
```

### 예상 항목 수

**WebSearch 기반으로 자연스럽게 결정됨 (품질 우선, 개수 제한 없음)**

- 품질 우선: 의미있는 항목이면 개수 제한 없음
- 억지로 개수 맞추기 금지: WebSearch 결과에 따라 자연스럽게 생성
- 예시: GASKET(간단) ~20개, WINDING(복잡) ~60개 (참고용일 뿐, 강제 아님)

---

## 2단계: 기술 정보 참조 (MANDATORY)

### [!] CRITICAL: 정확한 기술 정보를 먼저 찾고, 그 다음에 FMEA 작성!

**필수 WebSearch (부품별)** - 5개 출처 모두 검색:

1. **IEC 표준**: `"IEC 60076 {부품명} failure modes transformer"`
2. **IEEE 표준**: `"IEEE C57.12 {부품명} failure analysis"`
3. **CIGRE 기술 브로슈어**: `"CIGRE {부품명} transformer failure statistics"`
4. **Transformer Magazine**: `"Transformer Magazine {부품명} failure case study"`
5. **일반 검색**: `"{부품명} transformer common failures root cause"`

### 검색 순서 (반드시 이 순서대로)

```
1. WebSearch 실행 (위 5가지 모두)
   ↓
2. 검색 결과 분석 및 정리
   - 실제 고장 형태 패턴
   - 표준 정의 고장 원인
   - 업계 표준 대책
   - 과거 사례 기반 S/O/D
   ↓
3. FMEA 항목 생성 시작
```

### 검색 결과 활용

- [OK] **IEC/IEEE 표준**: 고장 형태 정의, 시험 기준
- [OK] **CIGRE**: 통계 데이터, 고장 사례
- [OK] **Transformer Magazine**: 실제 사례, 근본 원인
- [OK] **일반 검색**: 최신 사례, 실무 지식

### 검증

- [X] 비현실적 시나리오 제거
- [X] 표준/문헌에 없는 고장 형태 제거
- [OK] 실제 고장 사례만 반영
- [OK] 출처 명시 (IEC/IEEE/CIGRE/Transformer Magazine)

**상세 가이드**: [references/websearch-mandatory.md](websearch-mandatory.md)

---

## 3단계: Excel 생성 알고리즘

### 4단계 알고리즘

1. **데이터 구조 계획**: fmea_data 리스트로 완전한 데이터 생성
2. **셀 병합 알고리즘**: A-E 컬럼만 병합 (부품명, 기능, 고장영향, S, 고장형태)
3. **빈 셀 방지**: validate_data() 검증
4. **일관성 보장**: verify_excel() 최종 검증

### [!] 출처 명시 (MANDATORY)

Excel Row 3에 **실제 사용한 출처만** 명시:
```
예시: 자료 출처: IEC 60076-1, CIGRE TB 642, Claude 전문 지식
```
[!] 주의: WebSearch로 실제 참조한 출처만 작성! 고정 템플릿 아님!

### [!] CRITICAL - 매번 다른 결과, 셀 병합 오류, 빈 셀 발생 방지

- [OK] 고정된 정렬 순서 (부품→기능→영향→모드→원인)
- [OK] 데이터 구조 먼저 생성 후 Excel 파일 생성
- [OK] apply_cell_merge() 함수로 명확한 병합
- [OK] 필수 20개 컬럼 빈 값 검증
- [OK] **Row 3에 실제 사용한 출처만 명시**

**상세 알고리즘**: [references/excel-generation.md](excel-generation.md)

---

## 품질 체크리스트

**[!] MANDATORY**: Excel 생성 후 **반드시** [SKILL.md의 [WIP] GATE 4](../SKILL.md#-gate-4-excel-생성-완료-검증-must-pass)를 통과해야 함!

**GATE 4 통과 전 상세 확인사항**:

### 항목 생성 품질
- [OK] 총 항목 수가 목표 범위 내인가?
- [OK] 제품 라이프사이클 4단계 적절히 반영되었는가?
- [OK] FMEA: 1-4단계 모두 고려 (설계 개선 초점)?
- [OK] WebSearch에서 발견된 고장원인을 사용했는가?
- [OK] 중복되는 항목은 없는가?
- [OK] 구체적이고 실무적인 표현을 사용했는가?

### H열/J열 상세 작성 검증 [BLOCKING]
**금지 패턴 체크**:
- [X] `(작업표준)`, `(검사기준)` 같은 시리즈명만 있는 출처 없는가?
- [X] `(작업표준 준수 확인)` 같은 기준값 없는 출처 없는가?
- [X] `토크렌치 사용` 같은 목표값 없는 대책 없는가?

**필수 포함 항목 체크**:
| 항목 | 내부문서 있음 | 외부표준만 있음 | 둘 다 없음 |
|------|-------------|---------------|----------|
| **출처** | `(W018 §3.2)` | `(IEC 60076-5 §8.2)` | `(일반)` |
| **기준값** | 45±5 N.m (필수!) | ±0.5% (필수!) | 구체적 기준 (필수!) |

> **주의**: 출처가 `(일반)`이어도 **기준값은 반드시 명시!**

### WebSearch 검증
- [OK] 5개 출처 모두 검색 완료?
- [OK] 검색 결과 요약 작성?
- [OK] 표준/문헌 기반 고장 형태 도출?
- [OK] 출처 명시 (Row 3에 실제 사용한 출처만)?

### Excel 생성 품질 ([WIP] GATE 4 기준)
- [OK] **입력 안내 메시지 20개 모두 추가** (A6-T6 전체, 누락 금지, M365 웹 호환)?
- [OK] **컬럼 너비 정확** (scripts/generate_fmea_excel.py:407-428 기준값)?
- [OK] **Row 5 높이 = 40** (정확히)?
- [OK] 20개 컬럼 모두 값 존재?
- [OK] A-E 컬럼 병합 완료?
- [OK] 정렬 순서 올바른가 (부품→S↓→영향→모드→원인)?
- [OK] 빈 셀 없는가?
- [OK] H~T열 반복 없는가? (각 항목마다 다른 대책)
- [OK] **validate_data() 통과**?
- [OK] **validate_logical_consistency() 통과**?

---

## GATE 4-A: Excel 생성 완료 검증

> **[BLOCKING]** Excel 생성 후 필수 검증!

```
## [DATA] GATE 4-A 체크포인트 (Excel 검증)

### 필수 기능 검증
| 검증 항목 | 기준 | 상태 |
|----------|------|------|
| 입력 안내 메시지 | 22개 (A6-V6) | O/X |
| Row 5 높이 | 40 (정확히) | O/X |
| 20개 컬럼 값 존재 | 100% | O/X |
| A-E 컬럼 병합 완료 | O | O/X |
| 정렬 순서 | 부품->S->영향->모드->원인 | O/X |

### 스크립트 검증 함수 통과
| 함수 | 대상 | 상태 |
|------|------|------|
| validate_failure_mode() | E열 금지어 | O/X |
| validate_failure_effect() | C열 금지어 | O/X |
| validate_diamond_structure() | 다이아몬드 | O/X |
| validate_source_presence() | H/J열 출처 | O/X |
| validate_lifecycle_balance() | 라이프사이클 | O/X |

[BLOCKING] 통과 조건: 필수 기능 5개 + 검증 함수 5개 모두 O
```

---

## GATE 4-B: 라이프사이클 균형 검증 (Post-FMEA 역검증)

> **[BLOCKING]** FMEA 완료 후 반드시 실행! 불균형 시 원인 추가 필요!

### 라이프사이클 4단계 균형 기준

| 단계 | 문서 유형 | 목표 비율 | 원인 예시 |
|------|----------|----------|----------|
| **설계** | CHECK, WORKFLOW, C | 15-25% | 설계 기준 오류, 계산 실수, 표준 미준수 |
| **재료** | R, C | 20-30% | 재질 불량, 자재 불량, 입고 검사 누락 |
| **제작** | W, I | 25-35% | 가공 불량, 조립 불량, 용접 불량, 치수 불량 |
| **시험** | P, I | 15-25% | 시험 누락, 측정 오류, 판정 오류, 검사 불량 |

**경고**: 특정 단계 50% 초과 시 과다 집중으로 판정

### Post-FMEA 검증 체크리스트

```
## [DATA] GATE 4 체크포인트 (Post-FMEA)

### 라이프사이클 균형 검증
| 단계 | 비율 | 개수 | 상태 |
|------|------|------|------|
| 설계 | __% | __개 | O/X (15-25% 범위) |
| 재료 | __% | __개 | O/X (20-30% 범위) |
| 제작 | __% | __개 | O/X (25-35% 범위) |
| 시험 | __% | __개 | O/X (15-25% 범위) |

[!] 경고 조건:
- 특정 단계 15% 미만: 추가 원인 검토 필요
- 특정 단계 50% 초과: 과다 집중, 재분배 필요

### 출처 누락 검증
| 항목 | 출처 명시 여부 | 상태 |
|------|---------------|------|
| B열 (기능) | O/X | [BLOCKING] 출처 필수 |
| C열 (고장영향) | O/X | 출처 권장 |
| E열 (고장형태) | O/X | [BLOCKING] 출처 필수 |
| F열 (고장원인) | O/X | [BLOCKING] 출처 필수 |

### failure_modes 매칭 (mandatory_docs 연계)
| 부품 | JSON failure_modes | FMEA 반영 여부 |
|------|-------------------|----------------|
| {부품명} | {failure_modes 배열} | O/X |

[BLOCKING] 통과 조건:
- 모든 단계 15% 이상 (시험 단계 특히 주의!)
- 특정 단계 50% 미만
- B/E/F열 출처 100% 명시
```

### 시험 단계 원인 부족 시 추가 예시

> **주의**: 시험 단계는 가장 부족하기 쉬운 단계!

**시험 단계 5가지 원인 유형**:
1. 시험 누락: `시험: 절연 저항 시험 누락`
2. 시험 방법 오류: `시험: 시험 전압 설정 오류`
3. 판정 기준 오류: `시험: 합격 기준 오판정`
4. 측정 불량: `시험: 센서 부착 위치 오류`
5. 검사 불량: `시험: 외관 검사 누락`

---

## 참조 문서

- **필수 문서 시스템**: [references/mandatory-docs.md](mandatory-docs.md)
- **WebSearch 가이드**: [references/websearch-mandatory.md](websearch-mandatory.md)
- **Excel 생성 알고리즘**: [references/excel-generation.md](excel-generation.md)
- **라이프사이클 균형**: [references/lifecycle-balance.md](lifecycle-balance.md)
